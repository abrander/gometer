package iec62056

import (
	"fmt"
	"testing"
)

func TestParse(t *testing.T) {
	testSet := map[string]Obis{
		"1.2":          Obis{"", "", "1", "2", "", ""},
		"1.2.3":        Obis{"", "", "1", "2", "3", ""},
		"4:1.2":        Obis{"4", "", "1", "2", "", ""},
		"4:1.2.3":      Obis{"4", "", "1", "2", "3", ""},
		"4-8:1.2.":     Obis{"4", "8", "1", "2", "", ""},
		"4-8:1.2.3":    Obis{"4", "8", "1", "2", "3", ""},
		"1.2*16":       Obis{"", "", "1", "2", "", "16"},
		"1.2.3*16":     Obis{"", "", "1", "2", "3", "16"},
		"4:1.2*16":     Obis{"4", "", "1", "2", "", "16"},
		"4:1.2.3*16":   Obis{"4", "", "1", "2", "3", "16"},
		"4-8:1.2.*16":  Obis{"4", "8", "1", "2", "", "16"},
		"4-8:1.2.3*16": Obis{"4", "8", "1", "2", "3", "16"},
		"1.2&16":       Obis{"", "", "1", "2", "", "16"},
		"1.2.3&16":     Obis{"", "", "1", "2", "3", "16"},
		"4:1.2&16":     Obis{"4", "", "1", "2", "", "16"},
		"4:1.2.3&16":   Obis{"4", "", "1", "2", "3", "16"},
		"4-8:1.2.&16":  Obis{"4", "8", "1", "2", "", "16"},
		"4-8:1.2.3&16": Obis{"4", "8", "1", "2", "3", "16"},
	}

	for raw, expected := range testSet {
		o := NewObis(raw)
		if *o != expected {
			fmt.Printf("Got: %+v, expected: %+v\n", *o, expected)
			t.Fail()
		}
	}
}
